(function(t){function e(e){for(var s,n,o=e[0],l=e[1],c=e[2],u=0,h=[];u<o.length;u++)n=o[u],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&h.push(r[n][0]),r[n]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);d&&d(e);while(h.length)h.shift()();return a.push.apply(a,c||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],s=!0,o=1;o<i.length;o++){var l=i[o];0!==r[l]&&(s=!1)}s&&(a.splice(e--,1),t=n(n.s=i[0]))}return t}var s={},r={app:0},a=[];function n(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=s,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=l;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";i("85ec")},"108a":function(t,e,i){"use strict";i("c31e")},"2b90":function(t,e,i){},"53fe":function(t,e,i){"use strict";i("c659")},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d"),i("5319"),i("ac1f"),i("d3b7");var s=i("2b0e"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("transition",[i("router-view")],1),i("div",{staticClass:"virBak-lb"}),i("div",{staticClass:"virBak-rb"})],1)},a=[],n={name:"App",components:{},beforeMount:function(){this.$store.commit("saveUser",this.$cookies.get("user"))}},o=n,l=(i("034f"),i("2877")),c=Object(l["a"])(o,r,a,!1,null,null,null),d=c.exports,u=i("8c4f"),h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"text-align":"center"}},[i("carrier-nav"),i("div",{staticClass:"svg-container"},[i("div",{staticStyle:{width:"100%","margin-top":"5vh",padding:"10px 5%"}},[i("carriers-list")],1)]),i("v-loading",{attrs:{show:t.loading}})],1)},p=[],f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"search-container"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.searchVal,expression:"searchVal"}],staticClass:"search-input",attrs:{placeholder:"e.g. 74218, Cas9, transformation protocol"},domProps:{value:t.searchVal},on:{input:function(e){e.target.composing||(t.searchVal=e.target.value)}}}),i("Button",{staticClass:"search-btn",attrs:{type:"warning"},on:{click:t.searchAll}},[t._v("Search")])],1),i("Collapse",{staticStyle:{"text-align":"left"},attrs:{simple:""}},[i("Panel",{attrs:{name:"1"}},[t._v(" Advanced screening "),i("div",{attrs:{slot:"content"},slot:"content"},[i("Form",{attrs:{model:t.searchResult}},[i("Row",{attrs:{gutter:32}},t._l(t.searchList,(function(e){return i("i-col",{key:e.field,attrs:{span:"4"}},[i("FormItem",{attrs:{"label-position":"top"}},[i("div",{staticStyle:{padding:"0 0 !important"},attrs:{slot:"label"},slot:"label"},[t._v(t._s(e.field))]),i("Select",{attrs:{filterable:"",multiple:"",transfer:!0},on:{"on-change":t.filterResult},model:{value:t.searchResult[e.field],callback:function(i){t.$set(t.searchResult,e.field,i)},expression:"searchResult[item.field]"}},t._l(e.values,(function(e){return i("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1)],1)})),1)],1)],1)])],1),i("Table",{attrs:{stripe:"",border:"",columns:t.cols,data:t.carriers},scopedSlots:t._u([{key:"operator",fn:function(e){var s=e.row;return[i("Button",{staticClass:"opt-btn",attrs:{type:"success"},on:{click:function(e){return t.showDetail(s.ID)}}},[t._v("detail")]),t.isVector?i("Button",{staticClass:"opt-btn",attrs:{type:"info"},on:{click:function(e){return t.eidtDetail(s)}}},[t._v("edit")]):t._e(),t.isVector?i("Poptip",{attrs:{confirm:"",transfer:!0,title:"Are you sure you want to delete this item?"},on:{"on-ok":function(e){return t.deleteOk(s.ID)}}},[i("Button",{staticClass:"opt-btn",attrs:{type:"error"}},[t._v("delete")])],1):t._e()]}}])}),i("Drawer",{attrs:{title:"edit",width:"600","mask-closable":!1,closable:!1},model:{value:t.editFlag,callback:function(e){t.editFlag=e},expression:"editFlag"}},[i("Form",[i("Row",{attrs:{gutter:32}},t._l(t.editCarr,(function(e,s){return i("i-col",{key:s,attrs:{span:"12"}},[i("FormItem",{attrs:{label:s,"label-position":"top"}},[i("Input",{model:{value:t.editCarr[s],callback:function(e){t.$set(t.editCarr,s,e)},expression:"editCarr[name]"}})],1)],1)})),1)],1),i("Divider"),i("div",[i("Button",{staticStyle:{"margin-right":"8px"},on:{click:function(e){t.editFlag=!1}}},[t._v("Cancel")]),i("Button",{attrs:{type:"primary"},on:{click:t.submitEdit}},[t._v("Submit")])],1)],1),i("v-loading",{attrs:{show:t.loading}})],1)},g=[],v=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.isShow?i("div",{staticClass:"loading"},[i("div",{staticStyle:{display:"inline-block",width:"20%","margin-top":"20px"}},[i("Alert",[t._v("加载中....")])],1),i("svg",{staticClass:"svg-container"},[i("path",{attrs:{id:"pulsar",stroke:"rgba(0,155,155,1)",fill:"none","stroke-width":"3","stroke-linejoin":"round",d:"M0,90L250,90Q257,60 262,87T267,95 270,88 273,92t6,35 7,-60T290,127 297,107s2,-11 10,-10 1,1 8,-10T319,95c6,4 8,-6 10,-17s2,10 9,11h210"}})])]):t._e()},m=[],b={name:"v-loading",props:{show:Boolean},beforeMount:function(){this.isShow=this.show},data:function(){return{isShow:!1}},watch:{show:function(t){console.log(t),this.isShow=t}}},y=b,w=(i("108a"),Object(l["a"])(y,v,m,!1,null,"41f2f373",null)),x=w.exports,_={name:"carriersList",components:{VLoading:x},props:{},data:function(){return{searchResult:{},searchVal:"",loading:!1,carriers:[],cols:[],currentPage:0,pageSize:0,total:0,editFlag:!1,editCarr:{},editId:"",searchList:[],carriersOld:[]}},beforeMount:function(){this.initPage()},methods:{filterResult:function(){for(var t=new Array,e=0;e<this.carriersOld.length;e++){var i=this.carriersOld[e];this.compare(i)&&t.push(i)}this.carriers=t},compare:function(t){var e=!0;for(var i in this.searchResult)for(var s=0;s<this.searchResult[i].length;s++)if(e=!1,t[i]===this.searchResult[i][s])return!0;return!!e},searchAll:function(){this.initPage()},submitEdit:function(){this.editCarr.id=this.editId;var t={carrier:JSON.stringify(this.editCarr)};this.loading=!0;var e=this;this.$axios.post("/snapGene/commitCarrier",t).then((function(t){e.loading=!1,e.editFlag=!1,console.log(t),e.initPage(),e.$Message.success("submit success")})).catch((function(t){e.loading=!1,e.editFlag=!1,e.$Message.error("system error!"),console.log(t)}))},deleteOk:function(t){console.log(t),this.loading=!0;var e={fileId:t},i=this;this.$axios.post("/snapGene/deleteCarrier",e).then((function(t){console.log(t),i.loading=!1,i.$Message.success("delete success"),i.initPage()})).catch((function(t){i.loading=!1,console.log(t)}))},eidtDetail:function(t){for(var e in this.editId=t.ID,t)"_id"!=e&&"ID"!=e&&"_index"!=e&&"_rowKey"!=e&&"id"!=e&&(this.editCarr[e]=t[e]);this.editFlag=!0},showDetail:function(t){this.$router.push({name:"carrier",query:{id:t}})},initPage:function(){this.initCols();var t={currentPage:this.currentPage,pageSize:this.pageSize,searchVal:this.searchVal},e=this;this.loading=!0,this.$axios.post("/home/initPage",t).then((function(t){console.log(t),e.loading=!1,e.carriers=t.data.retMap.carriers,e.carriersOld=t.data.retMap.carriers,e.total=t.data.retMap.total,e.searchList=t.data.retMap.searchList;for(var i=0;i<e.searchList.length;i++){var s=e.searchList[i];e.searchResult[s.field]=new Array}})).catch((function(t){e.loading=!1,console.log(t)}))},initCols:function(){var t=new Array;t.push({type:"selection",width:60,align:"center"}),t.push({title:this.$t("CAT"),key:"CAT",width:100,sortable:!0}),t.push({title:this.$t("NAME"),key:"NAME",sortable:!0}),t.push({title:this.$t("BACKBONE载体骨架"),key:"BACKBONE载体骨架",width:200,sortable:!0}),t.push({title:this.$t("PROMOTER"),key:"PROMOTER",sortable:!0}),t.push({title:this.$t("EXPRESSIONCASSETTE表达框"),key:"EXPRESSIONCASSETTE表达框",sortable:!0}),t.push({title:this.$t("operator"),slot:"operator",width:250}),this.cols=t}},computed:{isVector:function(){return void 0!==this.$store.getters.getName&&!(!this.$store.getters.isVector||!this.$store.getters.isReviewer)}}},k=_,C=(i("f550"),Object(l["a"])(k,f,g,!1,null,"6c098a15",null)),S=C.exports,A=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("nav",{staticClass:"navbar navbar-dark",staticStyle:{"background-color":"#0483c8"}},[s("a",{staticClass:"navbar-brand",staticStyle:{display:"inline-block"},on:{click:t.goHome}},[s("img",{staticStyle:{width:"200px"},attrs:{src:i("c676"),alt:""}})]),s("form",{staticClass:"form-inline my-2 my-lg-0"},[t.hasUser?t._e():s("Button",{attrs:{type:"success",size:"large"},on:{click:t.gotologin}},[t._v("login")]),t.hasUser?s("button",{staticClass:"btn btn-success",on:{click:t.gotoAdmin}},[t._v(t._s("hello,"+t.user.name))]):t._e()],1)])},L=[],T=(i("b0c0"),i("2b3d"),i("3ca3"),i("ddb0"),i("bc3a")),O=i.n(T),E={loginUrl:"http://cibr.server.com:8080/login?service=",downLoad:function(t,e,i){O()({url:e,data:t,method:"post",responseType:"blob"}).then((function(t){var e=t.data;if(e){var s=window.URL.createObjectURL(new Blob([e])),r=document.createElement("a");r.style.display="none",r.href=s,r.setAttribute("download",i),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(r.href),document.body.removeChild(r)}}))}},$=E,F={name:"carrierNav",data:function(){return{user:{}}},mounted:function(){this.initPage()},methods:{initPage:function(){var t=this;this.$axios.get("/home/user").then((function(e){console.log(e),t.$cookies.set("user",e.data.retMap.user),t.$store.commit("saveUser",e.data.retMap.user),t.user=e.data.retMap.user})).catch((function(t){console.log(t)}))},goHome:function(){this.$router.push("/home")},gotologin:function(){var t=window.location.href;t=t.replaceAll(":","%3A").replaceAll("/","%2F"),window.location.href=$.loginUrl+t},gotoAdmin:function(){this.$router.push("/config")}},computed:{hasUser:function(){return console.log(this.user.name),void 0!=this.user.name}}},M=F,P=Object(l["a"])(M,A,L,!1,null,"578da8fa",null),j=P.exports,D={name:"home",components:{VLoading:x,CarrierNav:j,CarriersList:S},data:function(){return{loading:!1,searchVal:""}},methods:{searchAll:function(){this.loading=!0;var t=this,e={searchVal:this.searchVal};this.$axios.post("/home/search",e).then((function(t){console.log(t)})).then((function(e){t.loading=!1,t.$Message.error("system error"),console.log(e)}))}}},B=D,N=(i("53fe"),Object(l["a"])(B,h,p,!1,null,"c0f5f7c0",null)),I=N.exports,R=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{width:"100%"}},[i("carrier-nav"),i("div",{staticStyle:{width:"90%",height:"650px","margin-left":"5%","margin-top":"3vh"}},[i("carrier-map",{attrs:{"gb-object":t.feature,"show-config-map":t.showConfigMap,carrier:t.carrier}})],1),i("v-loading",{attrs:{show:t.loading}})],1)},U=[],z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{width:"100%",height:"90vh","min-height":"650px"}},[i("div",{staticClass:"svg-container",staticStyle:{display:"inline-block",width:"70%",height:"100%"}},[i("svg",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"carrierSvg",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"}},[i("defs",{attrs:{id:"textLine"}},[t._l(t.rulerPaths,(function(t){return i("path",{key:t.id,attrs:{d:t.d,id:t.id}})})),t._l(t.defsList,(function(t){return i("path",{key:t,attrs:{d:t.d,id:t.id}})}))],2),i("text",{attrs:{id:"trackName",transform:t.trackNameTrans,"font-size":t.titleFontSize}},[t._v(t._s(t.trackName))]),i("text",{attrs:{id:"titleDesc",transform:t.titleDescTrans,"font-size":t.titleFontSize}},[t._v(t._s(t.titleDesc))]),i("g",{attrs:{id:"mainContainer",transform:t.cTrans}},[i("path",{attrs:{d:t.circle,stroke:"black",fill:"transparent","stroke-linecap":"butt","stroke-width":"3"}}),t._l(t.rulerItems,(function(t){return i("path",{key:t.d,attrs:{d:t.d,stroke:"black",fill:"transparent","stroke-width":"2"}})})),t._l(t.rulerTexts,(function(e){return i("text",{key:e.id,attrs:{"font-size":"10px"}},[i("textPath",{attrs:{"xlink:href":e.href}},[t._v(t._s(e.text))])])})),t._l(t.featureList,(function(e){return i("path",{key:e,staticClass:"show-detail",staticStyle:{cursor:"pointer"},attrs:{id:e.id,label:e.label,d:e.d,fill:e.fill,stroke:"black","stroke-width":"1"},on:{click:function(i){return t.showDetail(e.feature)}}})})),t._l(t.featureTitleList,(function(e){return i("text",{key:e,attrs:{"font-size":"12px"}},[i("textPath",{attrs:{id:e.id,"xlink:href":e.href}},[t._v(t._s(e.realText))])])}))],2)])]),i("div",{staticClass:"right-detail"},[i("Card",{staticStyle:{width:"100%"},attrs:{title:"detail",icon:"ios-options",padding:0}},[i("Button",{attrs:{slot:"extra",type:"primary"},on:{click:t.downlondPDF},slot:"extra"},[t._v("export")]),t._l(t.carrierDetailList,(function(t){return i("Cell",{key:t.field,attrs:{title:t.field}},[i("input",{attrs:{slot:"extra"},domProps:{value:t.val},slot:"extra"})])}))],2),i("card",{staticStyle:{width:"100%"},attrs:{title:"sequence"}},[i("Button",{attrs:{slot:"extra",type:"primary"},on:{click:t.downloadDna},slot:"extra"},[t._v("download .dna")]),i("div",{staticStyle:{width:"100%","word-break":"break-all"}},[t._v(" "+t._s(t.gbObject.seq)+" ")])],1)],1),i("Drawer",{attrs:{title:"Detail",width:"500",closable:!1},model:{value:t.showFeature,callback:function(e){t.showFeature=e},expression:"showFeature"}},[t._v(". "),t._l(t.featureDetail,(function(e,s){return i("div",{key:s,staticStyle:{width:"100%","border-bottom":"1px solid darkgray"}},[i("Row",[i("i-col",{staticStyle:{"font-size":"16px"},attrs:{span:"12"}},[t._v(t._s(s))]),i("i-col",{staticStyle:{"font-size":"16px"},attrs:{span:"12"}},[t._v(t._s(e))])],1)],1)}))],2)],1)},q=[],V=(i("d81d"),i("a15b"),i("b680"),{name:"carrierMap",props:{gbObject:Object,showConfigMap:Object,carrier:Object},data:function(){return{showFeature:!1,featureDetail:{},cTrans:"",cx:0,cy:0,useH:0,useW:0,r:0,width:10,maxArrow:100,seq:"",title:"",features:[],trackHeight:35,textFontSize:12,map:{},fileMap:{},searchList:{},defsList:[],featureList:[],featureTitleList:[],mainTrans:"",trackName:"",titleDesc:"",trackNameTrans:"",titleDescTrans:"",titleFontSize:"16px",rulerPaths:[],rulerTexts:[],rulerItems:[],circle:"",carrierDetailList:[]}},mounted:function(){this.initPage()},methods:{showDetail:function(t){this.featureDetail=t,this.showFeature=!0},downloadDna:function(){var t={fileId:this.carrier.ID};$.downLoad(t,"/snapGene/downLoad",this.carrier.CAT+"_"+this.carrier.NAME+".dna")},downlondPDF:function(){var t=document.getElementById("carrierSvg"),e=t.outerHTML,i={id:this.carrier.ID,svgBase64:e,svgWidth:this.useW+"",svgHeight:this.useH+""};$.downLoad(i,"/snapGene/exportFile",this.carrier.CAT+"_"+this.carrier.NAME+".pdf")},initPage:function(){console.log(this.$(".svg-container").height()),console.log(this.$(".svg-container").width()),this.useH=parseFloat(this.$(".svg-container").height()),this.useW=parseFloat(this.$(".svg-container").width()),this.r=.49*Math.min(this.useH,this.useW),this.cx=this.useH/2,this.cy=this.useW/2,this.cTrans="translate("+this.useW/2+","+this.useH/2+")",this.circle=this.getTextPath(1,this.gbObject.seq.length,this.gbObject.seq.length,this.r);var t=this.gbObject.features;t.sort((function(t,e){return Math.abs(e.start-e.end)-Math.abs(t.start-t.end)})),this.trackName=this.gbObject.name,this.titleDesc=this.gbObject.seq.length+"碱基对";var e=10*this.gbObject.name.length/2;this.trackNameTrans="translate("+(this.useW/2-e)+","+this.useH/2+")",this.titleDescTrans="translate("+(this.useW/2-50)+","+(this.useH/2+30)+")",console.log(11111),this.drawRuler(),console.log(2222),this.drawFeature(),this.mainTrans="translate("+this.useW+","+this.useH+")",this.initCarrier()},initCarrier:function(){for(var t in void 0!=this.carrier.SEQUENCE&&""!=this.carrier.SEQUENCE||(this.carrier.SEQUENCE=this.gbObject.seq),this.carrierDetailList=new Array,this.carrier)if("_id"!=t&&"ID"!=t.toUpperCase()&&(void 0==this.showConfigMap[t]||this.showConfigMap[t].pageshow)&&"SEQUENCE"!=t){var e={field:t,val:this.carrier[t]};this.carrierDetailList.push(e)}},drawFeature:function(){var t=this,e=new Array,i=this;this.defsList=new Array,this.featureList=new Array,this.featureTitleList=new Array,this.gbObject.features.map((function(s){if("source"!=s.type){s.start=parseInt(s.start),s.end=parseInt(s.end);var r=Math.max(s.start,s.end),a=Math.min(s.start,s.end);s.start=a,s.end=r;var n=0,o=s.label||s.note;t.map[o]=s;var l=o;o.length*t.textFontSize>Math.abs(s.end-s.start)&&(l=o.substring(0,Math.ceil(Math.abs(s.end-s.start)/i.textFontSize))+"...");var c=Math.max(o.length*t.textFontSize+s.start,s.end);e.length>0&&e.map((function(t){t.start<c&&t.end>s.start&&(n=Math.max(n,t.index+1))})),e.push({start:s.start,end:c,index:n});var d=i.gbObject.seq.substring(s.start-1,s.end);s.seq=d;var u=i.r-20-n*i.trackHeight,h=i.getPath(s.start,s.end,i.gbObject.seq.length,u,s.stand),p={id:s.type,d:h,fill:i.randomColor(s.type),label:o,feature:s};i.featureList.push(p);var f=i.getTextPath(s.start,s.start+i.gbObject.seq.length-s.end,i.gbObject.seq.length,u-25),g={id:o.replaceAll(" ",""),d:f};i.defsList.push(g);var v={id:o.replaceAll(" ",""),href:"#"+o.replaceAll(" ",""),realText:l};i.featureTitleList.push(v)}}))},drawRuler:function(){var t=Math.ceil(this.gbObject.seq.length/1e3);this.rulerPaths=new Array,this.rulerTexts=new Array,this.rulerItems=new Array;for(var e=0;e<t;e++){var i=this.transToSE(1e3*e,this.gbObject.seq.length,this.r),s=this.transToSE(1e3*e,this.gbObject.seq.length,this.r-5),r=["M",i.x,i.y,"L",s.x,s.y],a={d:r.join(" ")};this.rulerItems.push(a);var n=this.getTextPath(1e3*e,1e3*(e+1),this.gbObject.seq.length,this.r-15),o={d:n,id:"line"+e};this.rulerPaths.push(o);var l={href:"#line"+e,text:1e3*e+1};this.rulerTexts.push(l)}},getTextPath:function(t,e,i,s){var r=this.transToSE(t,i,s),a=this.transToSE(e,i,s),n=e-t>i/2?1:0,o=["M",r.x,r.y,"A",s,s,0,n,1,a.x,a.y];return o.join(" ")},randomColor:function(t){switch(t){case"misc_feature":return"#696969";case"rep_origin":return"#FFFF00";case"CDS":return"#A52A2A";case"primer_bind":return"#9400D3";case"promoter":return"#F0FFFF";case"polyA_signal":return"#A9A9A9";default:return"#BC8F8F"}},getPath:function(t,e,i,s,r){t=parseInt(t),e=parseInt(e),i=parseInt(i),s=parseInt(s);var a=this.maxArrow/2;if(e-t+1<this.maxArrow&&(a=Math.abs(t-e)/3),"-"==r){var n=this.transToSE(t+a,i,s),o=this.transToSE(e,i,s),l=this.transToSE(t+a,i,s-this.width),c=this.transToSE(e,i,s-this.width),d=this.transToSE(t,i,s-this.width/2),u=this.transToSE(t+a,i,s+5),h=this.transToSE(t+a,i,s-this.width-5),p=e-t>i/2?1:0,f=["M",n.x,n.y,"A",s,s,0,p,1,o.x,o.y],g=["L",c.x,c.y],v=["A",s-this.width,s-this.width,0,p,0,l.x,l.y],m=["L",h.x,h.y,"L",d.x,d.y,"L",u.x,u.y,"L",n.x,n.y],b=new Array;return b.push.apply(b,f),b.push.apply(b,g),b.push.apply(b,v),b.push.apply(b,m),b.join(" ")}var y=this.transToSE(t,i,s),w=this.transToSE(e-a,i,s),x=this.transToSE(t,i,s-this.width),_=this.transToSE(e-a,i,s-this.width),k=this.transToSE(e,i,s-this.width/2),C=this.transToSE(e-a,i,s+5),S=this.transToSE(e-a,i,s-this.width-5),A=e-t>i/2?1:0,L=["M",_.x,_.y,"A",s-this.width,s-this.width,0,A,0,x.x,x.y],T=["L",y.x,y.y],O=["A",s,s,0,A,1,w.x,w.y],E=["L",C.x,C.y,"L",k.x,k.y,"L",S.x,S.y,"L",_.x,_.y],$=new Array;return $.push.apply($,L),$.push.apply($,T),$.push.apply($,O),$.push.apply($,E),$.join(" ")},transToSE:function(t,e,i){t=parseFloat(t),e=parseFloat(e),i=parseFloat(i);var s=t/e,r=360*s,a=r*(Math.PI/180),n=(Math.sin(a)*i).toFixed(2),o=-(Math.cos(a)*i).toFixed(2);return{x:n,y:o}}},watch:{gbObject:function(){this.initPage()}}}),H=V,G=(i("fe29"),Object(l["a"])(H,z,q,!1,null,"e9a0647a",null)),J=G.exports,W={name:"carrierDetail",components:{VLoading:x,CarrierMap:J,CarrierNav:j},data:function(){return{loading:!1,feature:{},showConfigMap:{},carrier:{},id:""}},mounted:function(){this.id=this.$route.query.id,console.log(this.id),this.initPage()},methods:{initPage:function(){this.loading=!0;var t=this;this.$axios.post("/snapGene/initPage",{id:this.id}).then((function(e){console.log(e,"========= detail ======"),t.loading=!1,t.feature=e.data.feature,t.showConfigMap=e.data.showConfigMap,t.carrier=e.data.carrier})).catch((function(e){t.loading=!1,console.log(e)}))}},watch:{getId:function(t){this.id=t,this.initPage()}},computed:{getId:function(){return this.$route.query.id}}},Q=W,K=Object(l["a"])(Q,R,U,!1,null,"7b1b9676",null),X=K.exports,Y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("carrier-nav"),i("div",{staticStyle:{width:"90%","margin-left":"5%","background-color":"white","border-radius":"10px","margin-top":"20px",padding:"10px 10px"}},[i("div",{staticClass:"accordion",attrs:{id:"accordionExample"}},[i("div",{staticClass:"card"},[t._m(0),i("div",{staticClass:"collapse show row",staticStyle:{padding:"10px 10px"},attrs:{id:"collapseOne","aria-labelledby":"headingOne","data-parent":"#accordionExample"}},[i("div",{staticClass:"card-body"},[t._l(t.show,(function(e){return i("div",{key:e.field,staticClass:"form-check form-check-inline col-4 col-sm-4 col-md-3 col-lg-2 col-xl-2",staticStyle:{width:"100%"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.pageshow,expression:"item.pageshow"}],staticClass:"form-check-input",staticStyle:{cursor:"pointer"},attrs:{type:"checkbox",id:e.field},domProps:{checked:Array.isArray(e.pageshow)?t._i(e.pageshow,null)>-1:e.pageshow},on:{click:function(i){return t.showText(e.pageshow)},change:function(i){var s=e.pageshow,r=i.target,a=!!r.checked;if(Array.isArray(s)){var n=null,o=t._i(s,n);r.checked?o<0&&t.$set(e,"pageshow",s.concat([n])):o>-1&&t.$set(e,"pageshow",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(e,"pageshow",a)}}}),i("label",{staticClass:"form-check-label",staticStyle:{cursor:"pointer"},attrs:{for:e.field}},[t._v(t._s(e.field))])])})),i("div",{staticClass:"modal-footer",staticStyle:{"margin-top":"10px"}},[i("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button",disabled:t.pageBtnDisabled},on:{click:t.saveShowList}},[t._v(" "+t._s(t.pageBtnText)+" ")])])],2)])]),i("div",{staticClass:"card"},[t._m(1),i("div",{staticClass:"collapse",attrs:{id:"collapseTwo","aria-labelledby":"headingTwo","data-parent":"#accordionExample"}},[i("div",{staticClass:"card-body"},[i("h3",[t._v("first table")]),t._l(t.pdfFixList,(function(e){return i("div",{key:e.field,staticClass:"form-check form-check-inline col-4 col-sm-4 col-md-3 col-lg-2 col-xl-2",staticStyle:{width:"100%"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.pdfposition,expression:"item.pdfposition"}],staticClass:"form-check-input",staticStyle:{cursor:"pointer"},attrs:{type:"checkbox",id:e.field+"1"},domProps:{checked:Array.isArray(e.pdfposition)?t._i(e.pdfposition,null)>-1:e.pdfposition},on:{click:function(i){return t.selectFix(e)},change:function(i){var s=e.pdfposition,r=i.target,a=!!r.checked;if(Array.isArray(s)){var n=null,o=t._i(s,n);r.checked?o<0&&t.$set(e,"pdfposition",s.concat([n])):o>-1&&t.$set(e,"pdfposition",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(e,"pdfposition",a)}}}),i("label",{staticClass:"form-check-label",staticStyle:{cursor:"pointer"},attrs:{for:e.field+"1"}},[t._v(t._s(e.field))])])})),i("h3",{staticStyle:{"margin-top":"50px"}},[t._v("Basic information 基本信息")]),t._l(t.pdfActivityList,(function(e){return i("div",{key:e.field,staticClass:"form-check form-check-inline col-4 col-sm-4 col-md-3 col-lg-2 col-xl-2",staticStyle:{width:"100%"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.pdfposition,expression:"item.pdfposition"}],staticClass:"form-check-input",staticStyle:{cursor:"pointer"},attrs:{type:"checkbox",id:e.field+"2"},domProps:{checked:Array.isArray(e.pdfposition)?t._i(e.pdfposition,null)>-1:e.pdfposition},on:{click:function(i){return t.selectActivity(e)},change:function(i){var s=e.pdfposition,r=i.target,a=!!r.checked;if(Array.isArray(s)){var n=null,o=t._i(s,n);r.checked?o<0&&t.$set(e,"pdfposition",s.concat([n])):o>-1&&t.$set(e,"pdfposition",s.slice(0,o).concat(s.slice(o+1)))}else t.$set(e,"pdfposition",a)}}}),i("label",{staticClass:"form-check-label",staticStyle:{cursor:"pointer"},attrs:{for:e.field+"2"}},[t._v(t._s(e.field))])])})),i("div",{staticClass:"modal-footer",staticStyle:{"margin-top":"10px"}},[i("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"button",disabled:t.pdfBtnDisabled},on:{click:t.saveShowConfig}},[t._v(" "+t._s(t.pdfBtnText)+" ")])])],2)])]),i("div",{staticClass:"card"},[t._m(2),i("div",{staticClass:"collapse",attrs:{id:"collapseThree","aria-labelledby":"headingThree","data-parent":"#accordionExample"}},[i("div",{staticClass:"card-body"},[i("form",{attrs:{id:"fileForm",method:"post",action:t.fileAciton,enctype:"multipart/form-data",target:"ifr"}},[t._m(3),t._m(4),i("button",{staticClass:"btn btn-primary mb-2",on:{click:t.submit}},[t._v("confirm")])]),i("iframe",{staticStyle:{display:"none"},attrs:{name:"ifr",id:"ifr"}})])])])])]),i("v-loading",{attrs:{show:t.loading}})],1)},Z=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"card-header",attrs:{id:"headingOne"}},[i("h2",{staticClass:"mb-0"},[i("button",{staticClass:"btn btn-link btn-block text-left",attrs:{type:"button","data-toggle":"collapse","data-target":"#collapseOne","aria-expanded":"true","aria-controls":"collapseOne"}},[t._v(" 展示项配置 ")])])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"card-header",attrs:{id:"headingTwo"}},[i("h2",{staticClass:"mb-0"},[i("button",{staticClass:"btn btn-link btn-block text-left collapsed",attrs:{type:"button","data-toggle":"collapse","data-target":"#collapseTwo","aria-expanded":"false","aria-controls":"collapseTwo"}},[t._v(" 导出配置 ")])])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"card-header",attrs:{id:"headingThree"}},[i("h2",{staticClass:"mb-0"},[i("button",{staticClass:"btn btn-link btn-block text-left collapsed",attrs:{type:"button","data-toggle":"collapse","data-target":"#collapseThree","aria-expanded":"false","aria-controls":"collapseThree"}},[t._v(" 上传 ")])])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"gbs"}},[t._v("请选择包含.gb和.dna文件的.zip压缩包")]),i("input",{staticClass:"form-control-file",attrs:{type:"file",accept:".zip",multiple:"false",id:"gbs",name:"all"}})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"dnas"}},[t._v("请选择描述文件Excel")]),i("input",{staticClass:"form-control-file",attrs:{type:"file",accept:".xlsx",multiple:"true",id:"dnas",name:"excl"}})])}],tt={name:"carrierConfig",components:{VLoading:x,CarrierNav:j},data:function(){return{loading:!1,ddd:"111",show:[],pdfFixList:[],pdfActivityList:[],pageBtnDisabled:!1,pageBtnText:"save changes",pdfBtnDisabled:!1,pdfBtnText:"save changes"}},mounted:function(){this.initPage();var t=document.getElementById("ifr"),e=this;t.onload=function(){e.loading=!1;var t=window.frames["ifr"].document.body.innerText;console.log(t)}},methods:{submit:function(){return this.loading=!0,this.$("#fileForm").submit(),!1},initPage:function(){var t=this;this.$axios.post("/snapGene/adminInit").then((function(e){if(e=e.data,console.log(e),t.show=e.showList,t.pdfFixList=JSON.parse(JSON.stringify(e.showList)),t.pdfActivityList=JSON.parse(JSON.stringify(e.showList)),void 0!=t.pdfFixList&&t.pdfFixList.length>0)for(var i in t.pdfFixList)"fix"==t.pdfFixList[i].pdfposition?t.pdfFixList[i].pdfposition=!0:t.pdfFixList[i].pdfposition=!1;if(void 0!=t.pdfActivityList&&t.pdfActivityList.length>0)for(var s in t.pdfActivityList)"activity"==t.pdfActivityList[s].pdfposition?t.pdfActivityList[s].pdfposition=!0:t.pdfActivityList[s].pdfposition=!1})).catch((function(e){console.log(e),t.$Message.error("system error")}))},selectFix:function(t){if(console.log(t.pdfposition),!t.pdfposition)for(var e=0;e<this.pdfActivityList.length;e++){var i=this.pdfActivityList[e];i.field===t.field&&(i.pdfposition=!1)}},selectActivity:function(t){if(console.log(t.pdfposition),!t.pdfposition)for(var e=0;e<this.pdfFixList.length;e++){var i=this.pdfFixList[e];i.field===t.field&&(i.pdfposition=!1)}},showText:function(t){console.log(t)},saveShowList:function(){var t=this;this.loading=!0,this.$axios.post("/snapGene/saveShowList",{showList:JSON.stringify(t.show)}).then((function(e){console.log(e),t.loading=!1,t.pageBtnDisabled=!1,t.pageBtnText="save changes",t.$Message.success("commit success！"),t.initPage()})).catch((function(e){console.log(e),t.pageBtnDisabled=!1,t.pageBtnText="save changes",t.$Message.error("system error")}))},saveShowConfig:function(){var t={fixList:JSON.stringify(this.pdfFixList),activityList:JSON.stringify(this.pdfActivityList)},e=this;this.pdfBtnDisabled=!0,this.pdfBtnText="submitting....",this.loading=!0,this.$axios.post("/snapGene/savePdfConfig",t).then((function(t){console.log(t),e.loading=!1,e.pdfBtnDisabled=!1,e.pdfBtnText="save changes",e.$Message.success("commit success！"),e.initPage()})).catch((function(t){e.loading=!1,console.log(t),e.pdfBtnDisabled=!1,e.pdfBtnText="save changes",e.$Message.error("system error")}))}},computed:{fileAciton:function(){return this.$axios.defaults.baseURL+"/snapGene/load_gb_data"}}},et=tt,it=Object(l["a"])(et,Y,Z,!1,null,"7243acc0",null),st=it.exports;s["default"].use(u["a"]);var rt=[{path:"",redirect:"/home"},{path:"/",redirect:"/home"},{path:"/home",component:I,meta:{index:0}},{path:"/carrier",name:"carrier",component:X,meta:{index:1}},{path:"/config",name:"config",component:st,meta:{index:2}}],at=new u["a"]({routes:rt}),nt=at,ot=i("1157"),lt=i.n(ot),ct=i("a925"),dt={},ut=dt,ht={},pt=ht;s["default"].use(ct["a"]);var ft=new ct["a"]({locale:localStorage.getItem("local")||"zh",messages:{zh:ut,en:pt}}),gt=ft,vt=i("e069"),mt=i.n(vt),bt=(i("dcad"),i("ab8b"),i("3e48"),i("2f62"));s["default"].use(bt["a"]);var yt=new bt["a"].Store({state:{user:{}},mutations:{saveUser:function(t,e){t.user=e}},getters:{getUser:function(t){return t.user},getName:function(t){return"zh"!=localStorage.getItem("local")?t.user.englishname:t.user.name},isResearcher:function(t){for(var e=0;e<t.user.roles.length;e++){var i=t.user.roles[e];if("999999"==i.roletype||"01"==i.roletype)return!0}return!1},isFeeder:function(t){for(var e=0;e<t.user.roles.length;e++){var i=t.user.roles[e];if("999999"==i.roletype||"02"==i.roletype)return!0}return!1},isReviewer:function(t){for(var e=0;e<t.user.roles.length;e++){var i=t.user.roles[e];if("999999"==i.roletype||"40"==i.roletype)return!0}return!1},isAdmin:function(t){for(var e=0;e<t.user.roles.length;e++){var i=t.user.roles[e];if("999999"==i.roletype)return!0}return!1},isBioAna:function(t){for(var e=0;e<t.user.roles.length;e++){var i=t.user.roles[e];if("999999"==i.roletype||"34"==i.roletype)return!0}return!1},isVector:function(t){for(var e=0;e<t.user.roles.length;e++){var i=t.user.roles[e];if("999999"==i.roletype)return!0}return"载体工程中心"==t.user.group.groupname},isGroupAdmin:function(t){if(t.user.group.groupadmin==t.user.id)return!0},isOther:function(t){for(var e=0;e<t.user.roles.length;e++){var i=t.user.roles[e];if("999999"==i.roletype||"09"==i.roletype)return!0}return!1},isCurrentUser:function(t){return function(e){if(t.user.id==e)return!0;for(var i=0;i<t.user.roles.length;i++){var s=t.user.roles[i];if("999999"==s.roletype)return!0}return!1}},isCurrentUserByName:function(t){return function(e){if(t.user.name==e)return!0;for(var i=0;i<t.user.roles.length;i++){var s=t.user.roles[i];if("999999"==s.roletype)return!0}return!1}}}}),wt=i("2b27"),xt=i.n(wt);s["default"].use(mt.a),s["default"].prototype.$axios=O.a,s["default"].prototype.$=lt.a,s["default"].prototype.$cookies=xt.a,O.a.defaults.baseURL="",O.a.interceptors.response.use((function(t){return t}),(function(t){if(console.log(t),t.response)switch(t.response.status){case 403:return nt.replace({path:"/login",query:{redirect:nt.currentRoute.fullPath}}),Promise.reject("转到登录啦！");case 401:var e=window.location.href.replaceAll("/","%2F").replaceAll(":","%3A");console.log(e),window.location.href=$.loginUrl+e;break;default:break}nt.replace({path:"/error",query:{redirect:nt.currentRoute.fullPath}})})),new s["default"]({router:nt,store:yt,i18n:gt,render:function(t){return t(d)}}).$mount("#app")},"85ec":function(t,e,i){},c31e:function(t,e,i){},c659:function(t,e,i){},c676:function(t,e,i){t.exports=i.p+"img/carrier.a7ddde2c.png"},d2b9:function(t,e,i){},f550:function(t,e,i){"use strict";i("2b90")},fe29:function(t,e,i){"use strict";i("d2b9")}});
//# sourceMappingURL=app.ece3eaf2.js.map